const URL = "/api/";

/**
 * Requests a registration of a device in the main server's database via the REST API and then handles the response with
 * the finishingFunction.
 * @param device data of the device.
 * @param deviceToken uuid deviceToken generated by the device.
 * @param csrftoken csrf token of the logged in user.
 * @param finishingFunction function that is executed after a response is received. It should take one
 *  parameter - a boolean value which represents either a successful or unsuccessful registration.
 */
function deviceCreate(device, deviceToken, csrftoken, finishingFunction) {
    let request = new XMLHttpRequest();
    request.open('POST', URL + 'device/create/' + deviceToken + '/', true);
    request.setRequestHeader('Content-Type', 'application/json');
    request.setRequestHeader('X-CSRFToken', csrftoken);
    request.onreadystatechange = function () {
        let result = false;
        if (this.readyState === XMLHttpRequest.DONE && this.status === 201) {
            result = true;
        }

        finishingFunction(result);
    };
    request.send(JSON.stringify(device));
}